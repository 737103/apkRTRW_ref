(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[909],{365:(e,a,t)=>{Promise.resolve().then(t.bind(t,555))},555:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>w});var n=t(5155),s=t(2115),i=t(2177),r=t(221),l=t(3308),d=t(4301),c=t(7120),u=t(5943),m=t(7223),o=t(5317),x=t(6104),h=t(285),p=t(6695),f=t(4165),g=t(7759),j=t(2523),b=t(8539),v=t(7481),y=t(7349),k=t(8856);let N=l.Ik({id:l.Yj().optional(),title:l.Yj().min(5,{message:"Judul harus diisi (minimal 5 karakter)."}),content:l.Yj().min(10,{message:"Konten pengumuman harus diisi (minimal 10 karakter)."}),date:l.Yj().optional(),createdAt:l.bz().optional()});function w(){let[e,a]=(0,s.useState)([]),[t,l]=(0,s.useState)(!1),[w,P]=(0,s.useState)(null),[C,B]=(0,s.useState)(!0),{toast:A}=(0,v.dj)(),I=(0,o.rJ)(x.db,"announcements"),F=async()=>{B(!0);try{let e=(0,o.P)(I,(0,o.My)("createdAt","desc")),t=(await (0,o.GG)(e)).docs.map(e=>({id:e.id,...e.data()}));a(t)}catch(e){console.error("Failed to load announcements from Firestore",e),A({title:"Gagal Memuat Data",description:"Tidak dapat memuat daftar pengumuman.",variant:"destructive"})}finally{B(!1)}};(0,s.useEffect)(()=>{F()},[]);let M=(0,i.mN)({resolver:(0,r.u)(N),defaultValues:{title:"",content:""}}),R=e=>{e||(P(null),M.reset()),l(e)},E=e=>{P(e),M.reset({title:e.title,content:e.content}),l(!0)},D=()=>{P(null),M.reset({title:"",content:""}),l(!0)},T=async e=>{try{if(w){let a=(0,o.H9)(x.db,"announcements",w.id);await (0,o.mZ)(a,{title:e.title,content:e.content}),A({title:"Pengumuman Diperbarui",description:'Pengumuman "'.concat(e.title,'" berhasil diperbarui.')})}else{let a=new Date().toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"});await (0,o.gS)(I,{...e,date:a,createdAt:new Date}),A({title:"Pengumuman Diterbitkan",description:'Pengumuman "'.concat(e.title,'" berhasil diterbitkan.')})}F(),R(!1)}catch(e){console.error("Failed to save announcement",e),A({title:"Gagal Menyimpan",description:"Terjadi kesalahan saat menyimpan data pengumuman.",variant:"destructive"})}},S=async e=>{try{let a=(0,o.H9)(x.db,"announcements",e);await (0,o.kd)(a),A({title:"Pengumuman Dihapus",description:"Pengumuman telah berhasil dihapus.",variant:"default"}),F()}catch(e){console.error("Failed to delete announcement",e),A({title:"Gagal Menghapus",description:"Terjadi kesalahan saat menghapus pengumuman.",variant:"destructive"})}};return(0,n.jsxs)("div",{className:"space-y-6 animate-in fade-in-50",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-4xl font-bold tracking-tight",children:"Kelola Pengumuman"}),(0,n.jsx)("p",{className:"text-lg text-muted-foreground",children:"Buat, edit, dan hapus pengumuman untuk pengguna."})]}),(0,n.jsxs)(h.$,{onClick:D,children:[(0,n.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Buat Pengumuman"]})]}),(0,n.jsx)(f.lG,{open:t,onOpenChange:R,children:(0,n.jsxs)(f.Cf,{className:"sm:max-w-[480px]",children:[(0,n.jsxs)(f.c7,{children:[(0,n.jsx)(f.L3,{children:w?"Edit Pengumuman":"Buat Pengumuman Baru"}),(0,n.jsx)(f.rr,{children:w?"Ubah detail pengumuman di bawah ini.":"Isi detail untuk membuat pengumuman baru."})]}),(0,n.jsx)(g.lV,{...M,children:(0,n.jsxs)("form",{onSubmit:M.handleSubmit(T),className:"space-y-4 py-4",children:[(0,n.jsx)(g.zB,{control:M.control,name:"title",render:e=>{let{field:a}=e;return(0,n.jsxs)(g.eI,{children:[(0,n.jsx)(g.lR,{children:"Judul"}),(0,n.jsx)(g.MJ,{children:(0,n.jsx)(j.p,{placeholder:"cth., Kerja Bakti Lingkungan",...a})}),(0,n.jsx)(g.C5,{})]})}}),(0,n.jsx)(g.zB,{control:M.control,name:"content",render:e=>{let{field:a}=e;return(0,n.jsxs)(g.eI,{children:[(0,n.jsx)(g.lR,{children:"Isi Pengumuman"}),(0,n.jsx)(g.MJ,{children:(0,n.jsx)(b.T,{placeholder:"Tulis isi pengumuman di sini...",className:"min-h-[120px]",...a})}),(0,n.jsx)(g.C5,{})]})}}),(0,n.jsxs)(f.Es,{children:[(0,n.jsx)(h.$,{type:"button",variant:"outline",onClick:()=>R(!1),children:"Batal"}),(0,n.jsx)(h.$,{type:"submit",children:"Simpan"})]})]})})]})}),(0,n.jsxs)(p.Zp,{className:"shadow-lg",children:[(0,n.jsxs)(p.aR,{children:[(0,n.jsxs)(p.ZB,{className:"text-2xl flex items-center gap-2",children:[(0,n.jsx)(c.A,{}),"Daftar Pengumuman"]}),(0,n.jsx)(p.BT,{children:"Berikut adalah daftar semua pengumuman yang telah diterbitkan."})]}),(0,n.jsx)(p.Wu,{children:C?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)(k.E,{className:"h-24 w-full"}),(0,n.jsx)(k.E,{className:"h-24 w-full"}),(0,n.jsx)(k.E,{className:"h-24 w-full"})]}):e.length>0?(0,n.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,n.jsxs)(p.Zp,{className:"bg-muted/30",children:[(0,n.jsxs)(p.aR,{children:[(0,n.jsxs)(p.ZB,{className:"flex justify-between items-start",children:[(0,n.jsx)("span",{children:e.title}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsxs)(h.$,{variant:"ghost",size:"icon",onClick:()=>E(e),children:[(0,n.jsx)(u.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Edit"})]}),(0,n.jsxs)(y.Lt,{children:[(0,n.jsx)(y.tv,{asChild:!0,children:(0,n.jsxs)(h.$,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",children:[(0,n.jsx)(m.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Hapus"})]})}),(0,n.jsxs)(y.EO,{children:[(0,n.jsxs)(y.wd,{children:[(0,n.jsx)(y.r7,{children:"Apakah Anda yakin?"}),(0,n.jsx)(y.$v,{children:"Tindakan ini tidak dapat diurungkan. Ini akan menghapus pengumuman secara permanen."})]}),(0,n.jsxs)(y.ck,{children:[(0,n.jsx)(y.Zr,{children:"Batal"}),(0,n.jsx)(y.Rx,{onClick:()=>S(e.id),className:"bg-destructive hover:bg-destructive/90",children:"Hapus"})]})]})]})]})]}),(0,n.jsx)(p.BT,{children:e.date||"Tanggal tidak tersedia"})]}),(0,n.jsx)(p.Wu,{children:(0,n.jsx)("p",{className:"text-sm text-foreground whitespace-pre-wrap",children:e.content})})]},e.id))}):(0,n.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,n.jsx)("p",{children:"Belum ada pengumuman yang diterbitkan."}),(0,n.jsxs)(h.$,{variant:"link",className:"mt-2",onClick:D,children:[(0,n.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Buat Pengumuman Pertama"]})]})})]})]})}},2523:(e,a,t)=>{"use strict";t.d(a,{p:()=>r});var n=t(5155),s=t(2115),i=t(9434);let r=s.forwardRef((e,a)=>{let{className:t,type:s,...r}=e;return(0,n.jsx)("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...r})});r.displayName="Input"},4301:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},5943:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(157).A)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]])},7120:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(157).A)("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]])},7759:(e,a,t)=>{"use strict";t.d(a,{C5:()=>j,MJ:()=>f,Rr:()=>g,eI:()=>h,lR:()=>p,lV:()=>c,zB:()=>m});var n=t(5155),s=t(2115),i=t(9708),r=t(2177),l=t(9434),d=t(5057);let c=r.Op,u=s.createContext({}),m=e=>{let{...a}=e;return(0,n.jsx)(u.Provider,{value:{name:a.name},children:(0,n.jsx)(r.xI,{...a})})},o=()=>{let e=s.useContext(u),a=s.useContext(x),{getFieldState:t,formState:n}=(0,r.xW)(),i=t(e.name,n);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=a;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...i}},x=s.createContext({}),h=s.forwardRef((e,a)=>{let{className:t,...i}=e,r=s.useId();return(0,n.jsx)(x.Provider,{value:{id:r},children:(0,n.jsx)("div",{ref:a,className:(0,l.cn)("space-y-2",t),...i})})});h.displayName="FormItem";let p=s.forwardRef((e,a)=>{let{className:t,...s}=e,{error:i,formItemId:r}=o();return(0,n.jsx)(d.J,{ref:a,className:(0,l.cn)(i&&"text-destructive",t),htmlFor:r,...s})});p.displayName="FormLabel";let f=s.forwardRef((e,a)=>{let{...t}=e,{error:s,formItemId:r,formDescriptionId:l,formMessageId:d}=o();return(0,n.jsx)(i.DX,{ref:a,id:r,"aria-describedby":s?"".concat(l," ").concat(d):"".concat(l),"aria-invalid":!!s,...t})});f.displayName="FormControl";let g=s.forwardRef((e,a)=>{let{className:t,...s}=e,{formDescriptionId:i}=o();return(0,n.jsx)("p",{ref:a,id:i,className:(0,l.cn)("text-sm text-muted-foreground",t),...s})});g.displayName="FormDescription";let j=s.forwardRef((e,a)=>{var t;let{className:s,children:i,...r}=e,{error:d,formMessageId:c}=o(),u=d?String(null!=(t=null==d?void 0:d.message)?t:""):i;return u?(0,n.jsx)("p",{ref:a,id:c,className:(0,l.cn)("text-sm font-medium text-destructive",s),...r,children:u}):null});j.displayName="FormMessage"},8539:(e,a,t)=>{"use strict";t.d(a,{T:()=>r});var n=t(5155),s=t(2115),i=t(9434);let r=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...s})});r.displayName="Textarea"},8856:(e,a,t)=>{"use strict";t.d(a,{E:()=>i});var n=t(5155),s=t(9434);function i(e){let{className:a,...t}=e;return(0,n.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-muted",a),...t})}}},e=>{var a=a=>e(e.s=a);e.O(0,[992,138,769,340,676,397,443,754,612,441,684,358],()=>a(365)),_N_E=e.O()}]);